### 线程

1. 内核线程：

   在有的系统上也成为轻量级进程（LWP），运行在内核空间，由内核来调度。

2. 用户进程：运行在用户空间，由线程库来调度。

   1. 一个进程中可以拥有的内核线程数小于用户线程数
   2. 线程的实现方式可分为三种模式：完全在用户空间实现、完全由内核调度、双层调度

3. 管理线程：

   1. 系统发送给进程的终止信号先由管理线程接收，管理线程再给其他工作线程发送同样的信号以终止它们
   2. 当终止工作线程或者工作线程主动退出时，管理线程必须等待它们结束，以避免僵尸进程。
   3. 如果主线程先于其他工作线程退出，则管理线程将阻塞它，执法哦所有其它工作线程都结束之后才唤醒它
   4. 回收每个线程堆栈使用的内存。

4. NPTL的优势：

   1. 内核线程不再是一个进程，因此避免了很多用进程模拟内核线程导致的语义问题
   2. 摒弃了管理线程，终止线程、回收线程堆栈等工作都可以由内核来完成
   3. 用于不存在管理线程，所以一个进程的线程可以运行在不同的CPU上，从而充分利用了多处理器系统来完成
   4. 线程的同步由内核来完成。隶属于不同进程的线程之间也能共享互斥锁，因此可实现跨进程的线程同步

### 线程同步

1. 读写锁：读操作大于写操作、写操作的优先级高于读操作
2. 条件变量：不具备公共区域保护的功能
   1. pthread_cond_wait：
      1. 阻塞等待一个条件变量
      2. 作用：
         - 阻塞等待条件变量（原子操作）
         - 释放已经掌握的互斥锁（原子操作）
         - 被唤醒时重新申请获取互斥锁
   2. pthread_cond_broadcast ：唤醒全部阻塞在条件变量上的线程（惊群现象）































